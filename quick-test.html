<!DOCTYPE html>
<html>
  <head>
    <title>Quick Test</title>
    <style>
      body {
        font-family: Arial;
        padding: 20px;
      }
      .log {
        background: #f5f5f5;
        padding: 5px;
        margin: 5px 0;
        border-radius: 3px;
      }
      .success {
        background: #d4edda;
      }
      .error {
        background: #f8d7da;
      }
      button {
        padding: 10px;
        margin: 5px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 3px;
      }
    </style>
  </head>
  <body>
    <h1>–ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h1>
    <button onclick="addTestIncome()">–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ—Ö–æ–¥</button>
    <button onclick="addTestExpense()">–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥</button>
    <button onclick="showStorageStatus()">–°—Ç–∞—Ç—É—Å —Ö—Ä–∞–Ω–∏–ª–∏—â–∞</button>
    <div id="log"></div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/cloud-storage.js"></script>
    <script src="js/app.js"></script>

    <script>
      function log(message, type = "info") {
        const div = document.createElement("div");
        div.className = `log ${type}`;
        div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
        document.getElementById("log").appendChild(div);
        console.log(message);
      }

      // Initialize app
      const app = new BudgetApp();

      async function addTestIncome() {
        log("–î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ—Ö–æ–¥...", "info");
        try {
          const formData = {
            amount: "500",
            person: "artur",
            category: "–∑–∞—Ä–ø–ª–∞—Ç–∞",
            description: "–¢–µ—Å—Ç–æ–≤—ã–π –¥–æ—Ö–æ–¥",
            date: new Date().toISOString().split("T")[0],
          };

          await app.addOperation("income", formData);
          log("‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π –¥–æ—Ö–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω!", "success");
        } catch (error) {
          log(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, "error");
        }
      }

      async function addTestExpense() {
        log("–î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥...", "info");
        try {
          const formData = {
            amount: "200",
            person: "valeria",
            category: "–ø—Ä–æ–¥—É–∫—Ç—ã",
            description: "–¢–µ—Å—Ç–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥",
            date: new Date().toISOString().split("T")[0],
          };

          await app.addOperation("expense", formData);
          log("‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω!", "success");
        } catch (error) {
          log(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, "error");
        }
      }

      function showStorageStatus() {
        log("–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å —Ö—Ä–∞–Ω–∏–ª–∏—â–∞...", "info");
        try {
          const status = EnhancedStorage.getStatus();
          log(
            `Cloud connected: ${status.cloudConnected}`,
            status.cloudConnected ? "success" : "error"
          );
          log(`Last sync: ${status.lastSync || "Never"}`, "info");
          log(`Operations count: ${app.data.operations.length}`, "info");
        } catch (error) {
          log(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞: ${error.message}`, "error");
        }
      }

      // Auto-initialize
      setTimeout(() => {
        log("üöÄ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ", "success");
        showStorageStatus();
      }, 2000);
    </script>
  </body>
</html>
