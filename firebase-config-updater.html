<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 1000px;
        margin: 20px auto;
        padding: 20px;
        background: #f5f5f5;
      }
      .panel {
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
      .config-input {
        width: 100%;
        height: 150px;
        font-family: "Courier New", monospace;
        font-size: 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 10px;
      }
      button {
        background: #28a745;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        cursor: pointer;
        margin: 8px;
        font-size: 14px;
      }
      button:hover {
        background: #218838;
      }
      .status {
        padding: 12px;
        border-radius: 6px;
        margin: 10px 0;
        font-weight: bold;
      }
      .success {
        background: #d4edda;
        color: #155724;
      }
      .error {
        background: #f8d7da;
        color: #721c24;
      }
      .info {
        background: #d1ecf1;
        color: #0c5460;
      }
      .code-output {
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 15px;
        font-family: "Courier New", monospace;
        font-size: 12px;
        white-space: pre-wrap;
        max-height: 300px;
        overflow-y: auto;
      }
    </style>
  </head>
  <body>
    <h1>üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</h1>

    <div class="panel">
      <h3>üìù –®–∞–≥ 1: –í—Å—Ç–∞–≤—å—Ç–µ –Ω–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Firebase</h3>
      <p>
        –°–∫–æ–ø–∏—Ä—É–π—Ç–µ <strong>–≤–µ—Å—å –±–ª–æ–∫ firebaseConfig</strong> –∏–∑ –Ω–æ–≤–æ–≥–æ Firebase
        –ø—Ä–æ–µ–∫—Ç–∞:
      </p>
      <textarea
        id="configInput"
        class="config-input"
        placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞:
const firebaseConfig = {
  apiKey: '–≤–∞—à-–Ω–æ–≤—ã–π-–∫–ª—é—á',
  authDomain: 'budget-artur-valeria.firebaseapp.com',
  databaseURL: 'https://budget-artur-valeria-default-rtdb.europe-west1.firebasedatabase.app',
  projectId: 'budget-artur-valeria',
  storageBucket: 'budget-artur-valeria.appspot.com',
  messagingSenderId: '123456789',
  appId: '1:123456789:web:abcdef'
};"
      ></textarea>

      <button onclick="parseConfig()">üîç –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é</button>
      <div id="parseStatus"></div>
    </div>

    <div class="panel" id="updatePanel" style="display: none">
      <h3>üìÅ –®–∞–≥ 2: –§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</h3>
      <div id="updateStatus" class="status info">
        –ì–æ—Ç–æ–≤ –∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é —Ñ–∞–π–ª–æ–≤...
      </div>

      <h4>js/firebase-config.js:</h4>
      <div id="configOutput" class="code-output"></div>

      <h4>js/cloud-storage.js (—Å–µ–∫—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏):</h4>
      <div id="storageOutput" class="code-output"></div>

      <button onclick="copyToClipboard('configOutput')">
        üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å firebase-config.js
      </button>
      <button onclick="copyToClipboard('storageOutput')">
        üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è cloud-storage.js
      </button>
    </div>

    <div class="panel" id="testPanel" style="display: none">
      <h3>üß™ –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</h3>
      <button onclick="testNewConfig()">
        üî¨ –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –Ω–æ–≤–æ–º—É –ø—Ä–æ–µ–∫—Ç—É
      </button>
      <div id="testResults"></div>
    </div>

    <script>
      let parsedConfig = null;

      function parseConfig() {
        const input = document.getElementById("configInput").value.trim();
        const statusEl = document.getElementById("parseStatus");

        try {
          // –ò–∑–≤–ª–µ–∫–∞–µ–º –æ–±—ä–µ–∫—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞
          let configText = input;

          // –£–±–∏—Ä–∞–µ–º "const firebaseConfig = " –µ—Å–ª–∏ –µ—Å—Ç—å
          configText = configText.replace(/^const\s+firebaseConfig\s*=\s*/, "");
          configText = configText.replace(/;?\s*$/, "");

          // –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –∫–∞–∫ JSON
          if (!configText.startsWith("{")) {
            throw new Error("–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å {");
          }

          // –ó–∞–º–µ–Ω—è–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏ –Ω–∞ –¥–≤–æ–π–Ω—ã–µ –¥–ª—è JSON
          configText = configText.replace(/'/g, '"');

          parsedConfig = JSON.parse(configText);

          // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
          const required = ["apiKey", "authDomain", "databaseURL", "projectId"];
          for (const field of required) {
            if (!parsedConfig[field]) {
              throw new Error(`–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ: ${field}`);
            }
          }

          statusEl.innerHTML =
            '<div class="status success">‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞!</div>';
          generateUpdatedFiles();
          document.getElementById("updatePanel").style.display = "block";
          document.getElementById("testPanel").style.display = "block";
        } catch (error) {
          statusEl.innerHTML = `<div class="status error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
          console.error("Parse error:", error);
        }
      }

      function generateUpdatedFiles() {
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π firebase-config.js
        const configFile = `// Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∏–∑ Firebase Console

const firebaseConfig = {
  apiKey: "${parsedConfig.apiKey}",
  authDomain: "${parsedConfig.authDomain}",
  databaseURL: "${parsedConfig.databaseURL}",
  projectId: "${parsedConfig.projectId}",
  storageBucket: "${
    parsedConfig.storageBucket || parsedConfig.projectId + ".appspot.com"
  }",
  messagingSenderId: "${parsedConfig.messagingSenderId || ""}",
  appId: "${parsedConfig.appId || ""}",
  measurementId: "${parsedConfig.measurementId || ""}"
};

// –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
export { firebaseConfig };

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
console.log('Firebase Config –∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞:', firebaseConfig.projectId);`;

        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è cloud-storage.js
        const storageConfig = `// Firebase Configuration
const firebaseConfig = {
  apiKey: "${parsedConfig.apiKey}",
  authDomain: "${parsedConfig.authDomain}",
  databaseURL: "${parsedConfig.databaseURL}",
  projectId: "${parsedConfig.projectId}",
  storageBucket: "${
    parsedConfig.storageBucket || parsedConfig.projectId + ".appspot.com"
  }",
  messagingSenderId: "${parsedConfig.messagingSenderId || ""}",
  appId: "${parsedConfig.appId || ""}",
  measurementId: "${parsedConfig.measurementId || ""}"
};`;

        document.getElementById("configOutput").textContent = configFile;
        document.getElementById("storageOutput").textContent = storageConfig;
      }

      function copyToClipboard(elementId) {
        const text = document.getElementById(elementId).textContent;
        navigator.clipboard
          .writeText(text)
          .then(() => {
            alert("‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!");
          })
          .catch((err) => {
            console.error("–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:", err);
            alert("‚ùå –û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è");
          });
      }

      function testNewConfig() {
        if (!parsedConfig) {
          alert("–°–Ω–∞—á–∞–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é!");
          return;
        }

        const resultsEl = document.getElementById("testResults");
        resultsEl.innerHTML =
          '<div class="status info">üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...</div>';

        // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ URL
        fetch(parsedConfig.databaseURL + "/.json")
          .then((response) => {
            if (response.ok) {
              resultsEl.innerHTML =
                '<div class="status success">‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞! –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞.</div>';
            } else {
              resultsEl.innerHTML =
                '<div class="status error">‚ùå –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL.</div>';
            }
          })
          .catch((error) => {
            resultsEl.innerHTML = `<div class="status error">‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${error.message}</div>`;
          });
      }
    </script>
  </body>
</html>
